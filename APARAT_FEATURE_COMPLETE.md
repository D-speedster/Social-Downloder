# ๐ฌ ูุงุจูุช ุฏุงูููุฏ ุงุฒ ุขูพุงุฑุงุช - ุชฺฉูู ุดุฏ

## ุชุงุฑุฎ: 2025-11-01
## ูุถุนุช: โ ูพุงุฏูโุณุงุฒ ฺฉุงูู

---

## ุฎูุงุตู
ฺฉ ุณุณุชู ฺฉุงูู ูุดุงุจู YouTube ุจุฑุง ุฏุงูููุฏ ุงุฒ ุขูพุงุฑุงุช ุจุง:
- ููุงุด thumbnail
- ุงุทูุงุนุงุช ฺฉุงูู ูุฏู
- ุงูุชุฎุงุจ ฺฉูุช ุจุง ุฏฺฉูู
- ุฏุงูููุฏ ู ุขูพููุฏ ุฎูุฏฺฉุงุฑ

---

## ูุงูโูุง ุงุฌุงุฏ ุดุฏู

### 1. `plugins/aparat_handler.py`
Handler ุงุตู ฺฉู:
- ููฺฉโูุง ุขูพุงุฑุงุช ุฑุง ุชุดุฎุต ูโุฏูุฏ
- ุงุทูุงุนุงุช ูุฏู ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ
- thumbnail ุฑุง ุฏุงูููุฏ ูโฺฉูุฏ
- ฺฉุจูุฑุฏ ุงูุชุฎุงุจ ฺฉูุช ุฑุง ูโุณุงุฒุฏ
- ูพุงู ุจุง ุนฺฉุณ ู ุฏฺฉููโูุง ุฑุง ุงุฑุณุงู ูโฺฉูุฏ

### 2. `plugins/aparat_callback.py`
Callback handler ฺฉู:
- ุงูุชุฎุงุจ ฺฉูุช ุฑุง ูุฏุฑุช ูโฺฉูุฏ
- ูุฏู ุฑุง ุจุง ฺฉูุช ุงูุชุฎุงุจ ุฏุงูููุฏ ูโฺฉูุฏ
- ุจู ุชูฺฏุฑุงู ุขูพููุฏ ูโฺฉูุฏ
- ูุงูโูุง ูููุช ุฑุง ูพุงฺฉ ูโฺฉูุฏ
- ุขูุงุฑ ุฑุง ุจุฑูุฒุฑุณุงู ูโฺฉูุฏ

### 3. ุชุบุฑุงุช ุฏุฑ `bot.py`
```python
import plugins.aparat_handler  # ๐ฌ Aparat downloader
import plugins.aparat_callback  # ๐ฌ Aparat callback
```

### 4. ุชุบุฑุงุช ุฏุฑ `plugins/start.py`
- ุงุถุงูู ุดุฏู `APARAT_REGEX`
- ุงุถุงูู ุดุฏู ุขูพุงุฑุงุช ุจู ูุณุช handler ูุง ูุฎุตูุต
- ุจุฑูุฒุฑุณุงู ูพุงูโูุง ุฑุงูููุง

---

## ุฌุฑุงู ฺฉุงุฑ

### ูุฑุญูู 1: ฺฉุงุฑุจุฑ ููฺฉ ูโูุฑุณุชุฏ
```
ฺฉุงุฑุจุฑ: https://www.aparat.com/v/abc123
```

### ูุฑุญูู 2: ุงุณุชุฎุฑุงุฌ ุงุทูุงุนุงุช
```
๐ ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ููฺฉ ุขูพุงุฑุงุช...
โณ ูุทูุงู ฺูุฏ ูุญุธู ุตุจุฑ ฺฉูุฏ...
```

### ูุฑุญูู 3: ููุงุด ุงุทูุงุนุงุช ู ฺฉูุชโูุง
```
[ุชุตูุฑ thumbnail]

๐ฌ ุนููุงู ูุฏู

๐ค ุขูพููุฏุฑ: ูุงู ุขูพููุฏุฑ
โฑ ูุฏุช ุฒูุงู: 5:30
๐ ุจุงุฒุฏุฏ: 123,456

๐ ูุทูุงู ฺฉูุช ููุฑุฏ ูุธุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:

[๐น 1080p (50.2 MB)] [๐น 720p (30.5 MB)]
[๐น 480p (15.8 MB)]  [๐น 360p (8.3 MB)]
[๐น 240p (4.1 MB)]   [๐น 144p (2.0 MB)]
[โ ูุบู]
```

### ูุฑุญูู 4: ฺฉุงุฑุจุฑ ฺฉูุช ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ
```
โฌ๏ธ ุฏุฑ ุญุงู ุฏุงูููุฏ...

๐ฌ ุนููุงู ูุฏู
๐น ฺฉูุช: 720p

โณ ูุทูุงู ุตุจุฑ ฺฉูุฏ...
```

### ูุฑุญูู 5: ุขูพููุฏ ุจู ุชูฺฏุฑุงู
```
โฌ๏ธ ุฏุฑ ุญุงู ุขูพููุฏ...

๐ฌ ุนููุงู ูุฏู
๐น ฺฉูุช: 720p
๐ฆ ุญุฌู: 30.5 MB

โณ ูุทูุงู ุตุจุฑ ฺฉูุฏ...
```

### ูุฑุญูู 6: ุงุฑุณุงู ูุงู
```
[ูุฏู]

๐ฌ ุนููุงู ูุฏู

๐น ฺฉูุช: 720p
๐ฆ ุญุฌู: 30.5 MB
๐ ุจุงุฒุฏุฏ: 123,456

๐ฅ ุงุฒ ุขูพุงุฑุงุช ุฏุงูููุฏ ุดุฏ
```

---

## ูฺฺฏโูุง

### โ ูุดุงุจู ุจุง YouTube
- ููุงุด thumbnail
- ุงุทูุงุนุงุช ฺฉุงูู (ุนููุงูุ ุขูพููุฏุฑุ ูุฏุช ุฒูุงูุ ุจุงุฒุฏุฏ)
- ุงูุชุฎุงุจ ฺฉูุช ุจุง ุฏฺฉูู
- ููุงุด ุญุฌู ูุงู ุจุฑุง ูุฑ ฺฉูุช
- ูพุงูโูุง ูุถุนุช (ุฏุงูููุฏุ ุขูพููุฏ)

### โ ูุณุชูู ุงุฒ YouTube
- ุจุฏูู ุงุณุชูุงุฏู ุงุฒ ฺฉูฺฉ
- ุชูุธูุงุช yt-dlp ุฌุฏุงฺฏุงูู
- Cache ุฌุฏุงฺฏุงูู
- Logger ุฌุฏุงฺฏุงูู
- Callback pattern ุฌุฏุงฺฏุงูู

### โ ฺฉูุชโูุง ูพุดุชุจุงู ุดุฏู
- 1080p
- 720p
- 480p
- 360p
- 240p
- 144p

---

## ุชูุงูุชโูุง ุจุง YouTube

| ูฺฺฏ | YouTube | Aparat |
|-------|---------|--------|
| ฺฉูฺฉ | โ ุฏุงุฑุฏ | โ ูุฏุงุฑุฏ |
| Callback prefix | `yt_` | `aparat_` |
| Cache | `video_cache` | `video_cache` (ูุดุชุฑฺฉ ุงูุง ุฌุฏุง) |
| Logger | `youtube_handler` | `aparat_handler` |
| Pattern | `youtube.com` | `aparat.com/v/` |
| Group | 5 | 4 |

---

## Pattern Recognition

### Regex:
```python
APARAT_REGEX = re.compile(
    r'^(?:https?://)?(?:www\.)?aparat\.com/v/([\w\-]+)/?$',
    re.IGNORECASE
)
```

### ููฺฉโูุง ูพุดุชุจุงู ุดุฏู:
โ `https://www.aparat.com/v/abc123`
โ `https://aparat.com/v/xyz789`
โ `aparat.com/v/test`
โ `http://www.aparat.com/v/video-id`

---

## ุชูุธูุงุช yt-dlp

### ุจุฑุง ุงุณุชุฎุฑุงุฌ ุงุทูุงุนุงุช:
```python
ydl_opts = {
    'quiet': True,
    'no_warnings': True,
    'extract_flat': False,
    'skip_download': True,
    # NO COOKIES!
}
```

### ุจุฑุง ุฏุงูููุฏ:
```python
ydl_opts = {
    'quiet': True,
    'no_warnings': True,
    'outtmpl': 'downloads/aparat_%(id)s.%(ext)s',
    'format': 'bestvideo[height<=720]+bestaudio/best[height<=720]',
}
```

---

## ูุฏุฑุช ุฎุทุง

### ุฎุทุงูุง ูุฏุฑุช ุดุฏู:
1. **ููฺฉ ูุงูุนุชุจุฑ**: ูพุงู ุฎุทุง ุจุง ุฑุงูููุง
2. **ูุฏู ุฏุฑ ุฏุณุชุฑุณ ูุณุช**: ูพุงู ุฎุทุง
3. **ุฎุทุง ุฏุฑ ุฏุงูููุฏ**: ูพุงู ุฎุทุง ุจุง ุฌุฒุฆุงุช
4. **ุฎุทุง ุฏุฑ ุขูพููุฏ**: ูพุงู ุฎุทุง
5. **Cache ุฎุงู**: ุฏุฑุฎูุงุณุช ุงุฑุณุงู ูุฌุฏุฏ ููฺฉ

---

## ูุงฺฏโฺฏุฐุงุฑ

### ูุงูโูุง ูุงฺฏ:
- `logs/aparat_handler.log` - Handler ุงุตู
- `logs/aparat_callback.log` - Callback handler

### ูุซุงู ูุงฺฏ:
```
2025-11-01 15:30:00 - aparat_handler - INFO - Aparat request from user 123456: https://aparat.com/v/abc123
2025-11-01 15:30:01 - aparat_handler - INFO - Extracting info from: https://aparat.com/v/abc123
2025-11-01 15:30:02 - aparat_handler - INFO - Found 6 formats
2025-11-01 15:30:02 - aparat_handler - INFO - Found quality 1080p: format_id=1080, size=50.2 MB
2025-11-01 15:30:02 - aparat_handler - INFO - Found quality 720p: format_id=720, size=30.5 MB
2025-11-01 15:30:03 - aparat_handler - INFO - Thumbnail downloaded: /tmp/xyz.jpg
2025-11-01 15:30:03 - aparat_handler - INFO - Quality selection displayed in 3.15s
2025-11-01 15:30:10 - aparat_callback - INFO - Aparat quality selection from user 123456: aparat_dl_720
2025-11-01 15:30:10 - aparat_callback - INFO - Downloading Aparat video: quality=720
2025-11-01 15:30:25 - aparat_callback - INFO - Download completed: downloads/aparat_abc123.mp4
2025-11-01 15:30:40 - aparat_callback - INFO - Cleaned up file: downloads/aparat_abc123.mp4
2025-11-01 15:30:40 - aparat_callback - INFO - Stats updated for user 123456
2025-11-01 15:30:40 - aparat_callback - INFO - Aparat download completed in 30.25s
```

---

## ุชุณุช

### ุชุณุช 1: ููฺฉ ุณุงุฏู
```
https://www.aparat.com/v/test123
```

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**
- ููุงุด thumbnail
- ุงุทูุงุนุงุช ฺฉุงูู
- ุฏฺฉููโูุง ฺฉูุช

### ุชุณุช 2: ุงูุชุฎุงุจ ฺฉูุช
ฺฉูฺฉ ุฑู `๐น 720p`

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**
- ุฏุงูููุฏ ุจุง ฺฉูุช 720p
- ุขูพููุฏ ุจู ุชูฺฏุฑุงู
- ุญุฐู ูุงู ูููุช

### ุชุณุช 3: ูุบู
ฺฉูฺฉ ุฑู `โ ูุบู`

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**
- ูพุงู "ุฏุงูููุฏ ูุบู ุดุฏ"
- ุญุฐู ุงุฒ cache

---

## ููุงุณู ุจุง ุณุงุฑ ุจุฎุดโูุง

### YouTube:
- ฺฉูฺฉ ุฏุงุฑุฏ โ
- ฺฉูุชโูุง ุจุดุชุฑ
- ุณุณุชู ูพฺุฏูโุชุฑ

### Aparat:
- ุจุฏูู ฺฉูฺฉ โ
- ฺฉูุชโูุง ุงุณุชุงูุฏุงุฑุฏ
- ุณุณุชู ุณุงุฏูโุชุฑ

### RadioJavan:
- API ูุฎุตูุต
- ููุท ุตูุช
- ุจุฏูู ุงูุชุฎุงุจ ฺฉูุช

### Universal:
- Web services
- ูพูุชูุฑูโูุง ูุชุนุฏุฏ
- ุจุฏูู yt-dlp

---

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### ูุงุฒููุฏโูุง:
- yt-dlp (ูุจูุงู ูุตุจ ุดุฏู)
- aiohttp (ุจุฑุง ุฏุงูููุฏ thumbnail)

### ุฑุงูโุงูุฏุงุฒ:
```bash
# Restart ุฑุจุงุช
Ctrl+C
python bot.py
```

### ุชุณุช:
```
https://www.aparat.com/v/test
```

---

## ุฎูุงุตู

โ **ุณุณุชู ฺฉุงูู ูุดุงุจู YouTube**
โ **ูุณุชูู ู ุจุฏูู ุชุฏุงุฎู**
โ **thumbnail + ุงุทูุงุนุงุช + ุงูุชุฎุงุจ ฺฉูุช**
โ **ุฏุงูููุฏ ู ุขูพููุฏ ุฎูุฏฺฉุงุฑ**
โ **ูุงฺฏโฺฏุฐุงุฑ ฺฉุงูู**
โ **ูุฏุฑุช ุฎุทุง ูู**

ููู ฺุฒ ุขูุงุฏู ุงุณุช! ููุท ุฑุจุงุช ุฑุง restart ฺฉูุฏ ู ุชุณุช ฺฉูุฏ! ๐๐ฌ
